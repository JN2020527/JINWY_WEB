<template>
  <div class="platform-sharing" :class="{ 'question-mode': showQuestionList }">
    <!-- 图书列表视图 -->
    <div v-if="!showQuestionList" class="book-list-view">
      <!-- 顶部筛选工具栏 -->
      <div class="selection-top">
      <el-select v-model="revisionStatus" placeholder="请选择" size="default" style="width: 140px;">
        <el-option label="正在修订" value="editing" />
        <el-option label="修订完成" value="completed" />
      </el-select>
      
      <el-date-picker
        v-model="selectedYear"
        type="year"
        placeholder="选择默认年份"
        size="default"
        style="width: 160px;"
      />
      
      <el-input
        v-model="searchKeyword"
        placeholder="搜索教辅名称"
        :prefix-icon="Search"
        size="default"
        style="width: 240px;"
      />
    </div>

    <!-- 分类导航 -->
    <div class="selection-nav">
      <ul class="nav-list">
        <li 
          v-for="(item, index) in categoryTabs" 
          :key="index"
          :class="{ active: currentTab === index }"
          @click="currentTab = index"
        >
          {{ item }}
        </li>
      </ul>
      <div class="view-toggle">
        <el-icon 
          :class="['view-icon', { active: viewMode === 'list' }]"
          @click="viewMode = 'list'"
        >
          <Menu />
        </el-icon>
        <el-icon 
          :class="['view-icon', { active: viewMode === 'grid' }]"
          @click="viewMode = 'grid'"
        >
          <Grid />
        </el-icon>
      </div>
    </div>

    <!-- 列表视图 -->
    <div v-if="viewMode === 'list'" class="list-view">
      <el-table :data="filteredResources" border stripe>
        <el-table-column prop="name" label="资源名称" width="400" />
        <el-table-column prop="stage" label="学段/学科" width="120" align="center" />
        <el-table-column prop="version" label="版本/册别" width="120" align="center" />
      </el-table>
    </div>

    <!-- 卡片视图 -->
    <div v-else class="grid-view">
      <div class="resource-grid">
        <div 
          v-for="item in filteredResources" 
          :key="item.id"
          class="card-wrapper"
          @click="handleBookClick(item)"
        >
          <div class="resource-card">
            <div class="card-cover">
              <el-image :src="item.cover" fit="contain" lazy>
                <template #error>
                  <div class="image-slot">
                    <el-icon><Picture /></el-icon>
                  </div>
                </template>
              </el-image>
            </div>
          </div>
          <div class="card-title">{{ item.name }}</div>
        </div>
      </div>
    </div>
    </div>

    <!-- 题目列表视图 -->
    <div v-else class="question-view">
      <!-- 阅读模式：左侧边栏 + 右侧内容 -->
      <div v-if="!isEditMode" class="question-content-wrapper">
        <!-- 左侧筛选栏 -->
        <div class="left-sidebar">
          <div class="sidebar-header">
            <span class="catalog-title">— 教辅目录 —</span>
          </div>

          <div class="sidebar-content">
            <div class="catalog-tree">
              <div 
                v-for="item in catalogTree" 
                :key="item.id"
                class="catalog-item"
              >
                <!-- 一级节点 -->
                <div 
                  class="catalog-node level-1"
                  :class="{ active: selectedCatalogId === item.id }"
                  @click="toggleNode(item)"
                >
                  <span class="expand-icon-wrapper">
                  <el-icon v-if="item.children" class="expand-icon" :class="{ expanded: item.expanded }">
                      <CaretRight />
                  </el-icon>
                  </span>
                  <span class="node-label">{{ item.label }}</span>
                </div>
                
                <!-- 二级节点 -->
                <div v-if="item.expanded && item.children" class="catalog-children level-2-wrapper">
                  <div 
                    v-for="child in item.children" 
                    :key="child.id"
                    class="catalog-item"
                  >
                    <div 
                      class="catalog-node level-2"
                      :class="{ active: selectedCatalogId === child.id }"
                      @click="toggleNode(child)"
                    >
                      <span class="expand-icon-wrapper">
                        <el-icon v-if="child.children" class="expand-icon" :class="{ expanded: child.expanded }">
                          <CaretRight />
                        </el-icon>
                      </span>
                      <span class="node-label">{{ child.label }}</span>
                  </div>
                    
                    <!-- 三级节点 -->
                    <div v-if="child.expanded && child.children" class="catalog-children level-3-wrapper">
                      <div 
                        v-for="subChild in child.children" 
                        :key="subChild.id"
                        class="catalog-node level-3"
                        :class="{ active: selectedCatalogId === subChild.id }"
                        @click="selectCatalog(subChild)"
                      >
                        <span class="expand-icon-wrapper"></span>
                        <span class="node-label">{{ subChild.label }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
          </div>
          </div>
        </div>

        <!-- 右侧内容区 -->
        <div class="right-content">
          <!-- 内容统计头部 -->
          <div class="content-header">
            <div class="content-info">
              <div class="content-title">
                <span class="title-text">{{ currentCatalogName }}</span>
          </div>
              <div class="content-count">
                <span class="count-label">共</span>
                <span class="count-number">{{ questionList.length }}</span>
                <span class="count-label">个知识点</span>
        </div>
          </div>
            <!-- 操作按钮 -->
            <div class="action-buttons">
              <el-tooltip content="收藏当前章节的全部知识点" placement="bottom">
                <el-button size="default" @click="handleAddCurrentToExam">
                  <el-icon><Star /></el-icon>
                  <span>收藏全部</span>
                </el-button>
              </el-tooltip>
              <el-tooltip content="编辑当前页面内容" placement="bottom">
                <el-button size="default" @click="handleEditCurrent">
                  <el-icon><Edit /></el-icon>
                  <span>编辑本页</span>
                </el-button>
              </el-tooltip>
              <el-tooltip content="下载当前章节的全部知识点" placement="bottom">
                <el-button size="default" @click="handleDownloadCurrent">
                  <el-icon><Download /></el-icon>
                  <span>下载全部</span>
                </el-button>
              </el-tooltip>
        </div>
      </div>

      <!-- 题目列表 -->
      <div class="question-list">
        <div 
          v-for="(question, index) in questionList" 
          :key="question.id"
          class="question-item"
        >
          <div class="question-header">
            <div class="question-number">{{ index + 1 }}.</div>
            <div class="question-text" v-html="question.content"></div>
            <button class="btn-screen" title="大屏演示" @click="handleScreenShow(question)">
              <el-icon><Monitor /></el-icon>
              <span>大屏演示</span>
            </button>
          </div>
          
          <!-- 详细讲解区域 -->
          <div v-if="question.showAnalysis" class="analysis-section">
            <div class="analysis-block">
              <div class="analysis-title">【答案】</div>
              <div class="analysis-content" v-html="question.answer"></div>
            </div>
            <div class="analysis-block" v-if="question.analysis">
              <div class="analysis-title">【解析】</div>
              <div class="analysis-content" v-html="question.analysis"></div>
            </div>
          </div>

          <div class="question-footer">
            <div class="question-meta">
              <span class="meta-item">类型：{{ question.type }}</span>
              <span class="meta-item">年份：{{ question.year }}</span>
            </div>
            <div class="question-actions">
              <button class="btn-analysis" @click="toggleAnalysis(question)">
                <el-icon><View /></el-icon>
                <span>{{ question.showAnalysis ? '收起详解' : '知识详解' }}</span>
              </button>
              <button class="btn-add" @click="addQuestionToBasket(question)">
                <el-icon><Plus /></el-icon>
                <span>加入备考</span>
              </button>
            </div>
          </div>
        </div>
      </div>
        </div>
      </div>

      <!-- 编辑模式：全屏编辑界面 -->
      <div v-else class="edit-mode-wrapper">
        <!-- 编辑内容区 -->
        <div class="right-edit-content">
          <!-- 编辑内容列表 -->
          <div class="edit-content">
            <div 
              v-for="(question, index) in questionList" 
              :key="question.id"
              class="edit-question-item"
            >
              <div class="question-header-edit">
                <div class="question-number-edit">{{ index + 1 }}.</div>
                <div class="question-title-edit">{{ question.type }}</div>
                <div class="question-meta-edit">
                  <span class="meta-item">年份：{{ question.year }}</span>
                </div>
                <div class="question-actions-edit">
                  <el-button size="small" text @click="handleEditQuestion(question)">
                    <el-icon><Edit /></el-icon>
                    编辑
                  </el-button>
                  <el-button size="small" text type="danger" @click="handleDeleteQuestion(question)">
                    <el-icon><Delete /></el-icon>
                    删除
                  </el-button>
                </div>
              </div>
              
              <div class="question-body-edit">
                <div class="question-content" v-html="question.content"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 大屏展示 -->
  <ScreenPresentation
    :visible="screenDialogVisible"
    :question="currentScreenQuestion"
    :questions="questionList"
    :current-index="currentScreenIndex"
    @close="closeScreenPresentation"
    @change-question="changeScreenQuestion"
  />

</template>

<script setup>
import { ref, computed } from 'vue'
import { Search, Menu, Grid, Picture, ArrowLeft, Monitor, View, Plus, CaretRight, Star, Edit, Download, DocumentChecked, Delete } from '@element-plus/icons-vue'
import { ElMessage } from 'element-plus'
import { mockResources } from '../mock/data'
import { useExamBasket } from '../store/examBasket'
import ScreenPresentation from './ScreenPresentation.vue'

// 使用备考篮
const { addToBasket } = useExamBasket()

// 图书列表相关
const revisionStatus = ref('completed')
const selectedYear = ref('')
const searchKeyword = ref('')
const currentTab = ref(0)
const viewMode = ref('grid')
const currentPage = ref(1)
const pageSize = ref(12)

const categoryTabs = ['滚动迁移', '复习重构']

const filteredResources = computed(() => {
  let result = mockResources
  
  if (searchKeyword.value) {
    result = result.filter(item => 
      item.name.toLowerCase().includes(searchKeyword.value.toLowerCase())
    )
  }
  
  const start = (currentPage.value - 1) * pageSize.value
  const end = start + pageSize.value
  return result.slice(start, end)
})

const totalCount = computed(() => mockResources.length)

// 题目列表相关
const showQuestionList = ref(false)
const currentBook = ref(null)

// 教辅目录树形数据（添加contentId关联内容）
const catalogTree = ref([
  {
    id: 1,
    label: '课标文言文',
    expanded: false,
    children: [
      {
        id: 11,
        label: '课标文言文阅读',
        expanded: false,
        contentId: 'unit-overview', // 单元知识梳理
        children: [
          { id: 111, label: '第1篇《论语》十二章（七上）', contentId: 'lunyu' },
          { id: 112, label: '第2篇《诫子书》（七下）', contentId: 'jiezishu' },
          { id: 113, label: '第3篇《爱莲说》（七下）', contentId: 'ailiansuo' }
        ]
      },
      {
        id: 12,
        label: '课标文言文对比探究',
    expanded: false,
        contentId: 'comparison'
      }
    ]
  },
  {
    id: 2,
    label: '课标古诗词',
    expanded: false,
    contentId: 'poetry'
  },
  {
    id: 3,
    label: '课外文言文',
    expanded: false,
    contentId: 'extra-classical'
  },
  {
    id: 4,
    label: '语言文字积累与梳理',
    expanded: false,
    contentId: 'language'
  },
  {
    id: 5,
    label: '整本书阅读',
    expanded: false,
    contentId: 'whole-book'
  },
  {
    id: 6,
    label: '现代文读写',
    expanded: false,
    contentId: 'modern-writing'
  },
  {
    id: 7,
    label: '写作',
    expanded: false,
    contentId: 'writing'
  }
])

// 当前选中的目录节点
const selectedCatalogId = ref(null)
// 当前选中的目录名称
const currentCatalogName = ref('')

// 递归收集节点及其所有子节点的contentId
const collectContentIds = (node) => {
  const contentIds = []
  
  // 如果当前节点有contentId，添加到列表
  if (node.contentId) {
    contentIds.push(node.contentId)
  }
  
  // 递归收集子节点的contentId
  if (node.children && node.children.length > 0) {
    node.children.forEach(child => {
      contentIds.push(...collectContentIds(child))
    })
  }
  
  return contentIds
}

// 切换节点展开/收起
const toggleNode = (node) => {
  if (node.children) {
    node.expanded = !node.expanded
    // 如果节点有子节点，也可以点击加载内容
    if (node.contentId || node.children.length > 0) {
      selectCatalog(node)
    }
  } else if (node.contentId) {
    // 如果是叶子节点且有内容，则选中
    selectCatalog(node)
  }
}

// 选择目录项
const selectCatalog = (node) => {
  selectedCatalogId.value = node.id
  currentCatalogName.value = node.label
  
  // 收集当前节点及其所有子节点的contentId
  const contentIds = collectContentIds(node)
  
  if (contentIds.length > 0) {
    // 根据收集到的所有contentId加载内容
    loadContentByIds(contentIds)
    const level = node.children ? (node.children[0]?.children ? '一级' : '二级') : '三级'
    console.log(`选择${level}目录:`, node.label, `共加载 ${questionList.value.length} 个知识点`)
  } else {
    questionList.value = []
    ElMessage.info('该章节内容正在编写中...')
  }
}

// 收藏当前内容
const handleAddCurrentToExam = () => {
  if (questionList.value.length === 0) {
    ElMessage.warning('暂无内容可收藏')
    return
  }
  
  questionList.value.forEach(question => {
    addToBasket(question)
  })
  ElMessage.success(`已收藏"${currentCatalogName.value}"（${questionList.value.length} 个知识点）`)
}

// 编辑模式控制
const isEditMode = ref(false)

// 编辑当前内容
const handleEditCurrent = () => {
  if (!currentCatalogName.value) {
    ElMessage.warning('请先选择要编辑的内容')
    return
  }
  isEditMode.value = true
}

// 退出编辑模式
const exitEditMode = () => {
  isEditMode.value = false
}

// 保存编辑
const handleSaveEdit = () => {
  ElMessage.success('保存成功')
  isEditMode.value = false
}

// 预览
const handlePreview = () => {
  ElMessage.info('预览功能')
}

// 下载编辑内容
const handleDownloadEdit = () => {
  ElMessage.info('下载功能')
}

// 编辑单个知识点
const handleEditQuestion = (question) => {
  ElMessage.info(`编辑知识点：${question.id}`)
}

// 删除单个知识点
const handleDeleteQuestion = (question) => {
  ElMessage.warning(`确定要删除这个知识点吗？`)
}

// 下载当前内容
const handleDownloadCurrent = () => {
  if (!currentCatalogName.value || questionList.value.length === 0) {
    ElMessage.warning('暂无内容可下载')
    return
  }
  ElMessage.success(`正在下载"${currentCatalogName.value}"（${questionList.value.length} 个知识点）`)
}

// 筛选条件
const filters = ref({
  source: 'platform',
  type: 'all',
  difficulty: 'all',
  year: 'all'
})

// 试题来源选项
const sourceOptions = [
  { label: '平台题库', value: 'platform' },
  { label: '本校上传', value: 'school' }
]

// 试题类型选项（简化版）
const typeOptions = [
  { label: '全部', value: 'all' },
  { label: '字词书写', value: 'word-writing' },
  { label: '现代文阅读', value: 'modern-reading' },
  { label: '文言文阅读', value: 'classical-reading' },
  { label: '名句名篇默写', value: 'famous-sentences' },
  { label: '诗歌鉴赏', value: 'poetry' },
  { label: '语言表达', value: 'language-expression' },
  { label: '作文', value: 'composition' },
  { label: '单选题', value: 'single-choice' },
  { label: '问答题', value: 'qa' }
]

// 试题难度选项
const difficultyOptions = [
  { label: '全部', value: 'all' },
  { label: '容易', value: 'easy' },
  { label: '较易', value: 'fairly-easy' },
  { label: '一般', value: 'medium' },
  { label: '较难', value: 'fairly-hard' },
  { label: '困难', value: 'hard' }
]

// 年份选项
const yearOptions = [
  { label: '全部', value: 'all' },
  { label: '2025', value: '2025' },
  { label: '2024', value: '2024' },
  { label: '2023', value: '2023' },
  { label: '2022', value: '2022' },
  { label: '2021', value: '2021' }
]

// 知识内容库（按contentId存储，每个contentId对应一个数组）
const contentLibrary = {
  // 《论语》十二章
  'lunyu': [
    {
      id: 101,
      content: '<strong>【原文节选】</strong><br/>子曰："学而时习之，不亦说乎？有朋自远方来，不亦乐乎？人不知而不愠，不亦君子乎？"<br/><br/><strong>【重点字词】</strong><br/>• 时习：按时温习<br/>• 说（yuè）：通"悦"，愉快<br/>• 愠（yùn）：生气，发怒<br/><br/><strong>【句子翻译】</strong><br/>孔子说："学习了（知识）并且按时温习它，不也是很愉快的吗？有志同道合的人从远方来，不也是很快乐的吗？别人不了解自己却不生气，不也是君子吗？"',
      type: '重点句段讲解',
      year: '2026',
      answer: '这三句话阐述了学习的乐趣、交友的快乐以及修养的境界，体现了孔子"学而不厌，诲人不倦"的教育思想和宽容大度的君子之风。<br/><br/>第一句强调学习要及时复习，温故知新，学习本身就是快乐的事情；第二句说明朋友之间的交流能够促进学习，增进友谊；第三句则体现了君子的修养，即使不被理解也不会生气，保持平和的心态。',
      analysis: '1. 运用设问句式，引人思考，三个"不亦...乎"构成排比，增强语势，富有感染力。<br/><br/>2. 内容层层递进，从学习到交友再到修养，体现了孔子完整的人格培养观念。<br/><br/>3. 这三句话不仅适用于古代的学习，对今天的我们同样具有重要的指导意义，教导我们要勤于学习、善于交友、宽容待人。',
    showAnalysis: false
  },
  {
      id: 102,
      content: '<strong>【原文节选】</strong><br/>子曰："温故而知新，可以为师矣。"<br/><br/><strong>【重点字词】</strong><br/>• 温：温习，复习<br/>• 故：旧的知识<br/>• 新：新的理解、体会<br/>• 为师：成为老师<br/><br/><strong>【句子翻译】</strong><br/>孔子说："温习旧知识从而得到新的理解和体会，凭借这一点就可以做老师了。"',
      type: '重点句段讲解',
      year: '2026',
      answer: '这句话强调了温习旧知识的重要性。通过不断复习已学的知识，能够获得新的理解和体会，达到这样的程度，就可以做老师了。<br/><br/>体现了孔子对学习方法的重视，认为学习不仅要不断获取新知识，还要善于温习旧知识，在温习中加深理解，产生新的感悟。',
      analysis: '1. "温故"和"知新"形成对比，说明学习是一个循环往复、螺旋上升的过程。<br/><br/>2. 提出了"温故知新"的学习方法，对今天的学习仍然有重要的指导意义。<br/><br/>3. 最后一句"可以为师矣"说明达到这种境界就具备了做老师的资格，体现了孔子对教师的高标准要求。',
    showAnalysis: false
  },
  {
      id: 103,
      content: '<strong>【原文节选】</strong><br/>子曰："学而不思则罔，思而不学则殆。"<br/><br/><strong>【重点字词】</strong><br/>• 罔（wǎng）：迷惑，感到迷茫而无所得<br/>• 殆（dài）：疑惑，危险<br/><br/><strong>【句子翻译】</strong><br/>孔子说："只学习却不思考，就会迷惑而无所得；只空想却不学习，就会疑惑而无所获。"',
      type: '重点句段讲解',
      year: '2026',
      answer: '这句话阐述了学习和思考的辩证关系，强调二者必须相互结合。只学习不思考，知识就不能消化理解；只思考不学习，就会陷入空想，没有根基。<br/><br/>学习和思考是认识过程中的两个阶段，学习是思考的基础，思考是学习的深化。',
      analysis: '1. 运用对比手法，将"学而不思"和"思而不学"两种片面做法进行比较，说明两者的弊端。<br/><br/>2. 提出了"学思结合"的学习方法，这是认识和掌握知识的根本方法。<br/><br/>3. 对今天的学习有重要启示：既要认真学习，又要善于思考，将学习和思考有机统一起来。',
      showAnalysis: false
    },
    {
      id: 104,
      content: '<strong>【原文节选】</strong><br/>子曰："三人行，必有我师焉。择其善者而从之，其不善者而改之。"<br/><br/><strong>【重点字词】</strong><br/>• 三人行：三个人一起走路（泛指多人）<br/>• 焉：于此，在其中<br/>• 善者：优点、长处<br/>• 从：跟从，学习<br/><br/><strong>【句子翻译】</strong><br/>孔子说："几个人一起走路，其中必定有可以做我老师的人。选择他们的优点学习，看到他们的缺点就对照自己改正。"',
      type: '重点句段讲解',
      year: '2026',
      answer: '这句话体现了谦虚好学的态度，强调要善于向他人学习，无论是学习别人的长处，还是以别人的短处为戒，都能使自己得到提高。<br/><br/>这种学习态度包含两个方面：一是虚心向他人学习长处，二是以他人的缺点为镜，反省自己，避免犯同样的错误。',
      analysis: '1. "三人行，必有我师焉"体现了孔子虚心好学的态度，认为每个人都有值得学习的地方。<br/><br/>2. "择其善者而从之，其不善者而改之"说明学习要有辨别能力，既要学习别人的长处，也要以别人的缺点为镜，反省自己。<br/><br/>3. 这种学习态度对今天仍然有重要意义，提醒我们要保持谦虚，善于向他人学习。',
      showAnalysis: false
    },
    {
      id: 105,
      content: '<strong>【原文节选】</strong><br/>子曰："知之为知之，不知为不知，是知也。"<br/><br/><strong>【重点字词】</strong><br/>• 知之为知之：知道就是知道<br/>• 不知为不知：不知道就是不知道<br/>• 是知也：这才是真正的智慧<br/><br/><strong>【句子翻译】</strong><br/>孔子说："知道就说知道，不知道就说不知道，这才是真正的智慧。"',
      type: '重点句段讲解',
      year: '2026',
      answer: '这句话强调了实事求是的学习态度，反对不懂装懂。真正的聪明智慧，不在于知道多少，而在于对待知识的诚实态度。<br/><br/>这体现了孔子对求知态度的重视，认为诚实是获取真知的前提。只有承认自己的不足，才能虚心学习，不断进步。',
      analysis: '1. 运用反复手法，"知之"与"不知"形成对比，强调对待知识要诚实。<br/><br/>2. 批评了不懂装懂的学习态度，提倡实事求是的求知精神。<br/><br/>3. 这种态度在今天仍然具有重要意义，提醒我们在学习中要诚实，不能自欺欺人。',
      showAnalysis: false
    },
    {
      id: 106,
      content: '<strong>【原文节选】</strong><br/>子曰："默而识之，学而不厌，诲人不倦，何有于我哉？"<br/><br/><strong>【重点字词】</strong><br/>• 默：默默地<br/>• 识（zhì）：记住<br/>• 厌：满足<br/>• 诲：教导<br/>• 何有于我哉：我做到了哪些呢<br/><br/><strong>【句子翻译】</strong><br/>孔子说："默默地记住所学的知识，学习不感到满足，教导别人不知疲倦，这些我做到了哪些呢？"',
      type: '重点句段讲解',
      year: '2026',
      answer: '这句话体现了孔子的谦虚态度和对自己的严格要求。他提出了三个标准：默默记忆、勤奋好学、热心教人，但又谦虚地说自己不知做到了哪些。<br/><br/>实际上这是孔子的自我勉励，也是对学生的期望和要求。这三点涵盖了学习的各个方面：积累知识、刻苦学习、无私传授。',
      analysis: '1. "默而识之"强调积累的重要性，学习要善于记忆和积累。<br/><br/>2. "学而不厌"体现了对学习的热爱和永不满足的求知精神。<br/><br/>3. "诲人不倦"展现了无私传授知识、热心教导他人的精神。<br/><br/>4. 最后的反问"何有于我哉"体现了孔子的谦虚，虽然做到了这些，却不自夸，这是君子的品格。',
    showAnalysis: false
  }
  ],
  
  // 《诫子书》
  'jiezishu': [
    {
      id: 201,
      content: '<strong>【原文】</strong><br/>夫君子之行，静以修身，俭以养德。非淡泊无以明志，非宁静无以致远。夫学须静也，才须学也，非学无以广才，非志无以成学。<br/><br/><strong>【作品背景】</strong><br/>这是诸葛亮写给儿子诸葛瞻的一封家书，作于蜀汉建兴十二年（234年）。诸葛亮一生为国操劳，临终前写下这篇文章，希望儿子能够修身养性、成才报国。<br/><br/><strong>【重点词语】</strong><br/>• 夫：句首发语词，无实义<br/>• 静：宁静、平静<br/>• 俭：俭朴、节俭<br/>• 淡泊：内心恬淡，不慕名利<br/>• 明志：表明志向<br/>• 致远：实现远大目标<br/>• 广才：增长才干',
      type: '文章整体讲解',
      year: '2026',
      answer: '文章阐述了修身养性、治学做人的深刻道理。诸葛亮认为君子的品行修养，应当以"静"和"俭"为根本：宁静可以修养身心，俭朴可以培养品德。<br/><br/>文章强调只有内心恬淡、不追求名利，才能树立远大志向；只有心境宁静、专心致志，才能实现远大目标。同时指出学习需要宁静的环境和心境，才干需要通过学习来增长，不学习就无法增长才干，没有志向就无法学有所成。',
      analysis: '1. 全文围绕"静"字展开，"静"是修身、明志、治学的前提条件，体现了古人"静以修身"的思想。<br/><br/>2. 逻辑严密：先谈修身之道（静、俭），再谈立志之法（淡泊、宁静），最后谈治学之要（学、志），层层深入。<br/><br/>3. 文章既有人生哲理，又有实践指导，充分体现了诸葛亮作为一代名相的智慧和对儿子的殷切期望。',
      showAnalysis: false
    },
    {
      id: 202,
      content: '<strong>【名句赏析】</strong><br/>"静以修身，俭以养德"<br/><br/><strong>【句意理解】</strong><br/>以宁静来修养身心，以俭朴来培养品德。',
      type: '名句赏析',
      year: '2026',
      answer: '这是全文的总领句，提出了修身养德的两个关键：静和俭。<br/><br/>"静"指内心平静，不受外界干扰，能够专注于自我修养。"俭"指生活俭朴，不追求物质享受，保持朴素的生活作风。<br/><br/>两者相辅相成：心静才能深入思考，俭朴才能不为物欲所累。这是诸葛亮一生践行的准则，也是他对儿子最重要的教诲。',
      analysis: '1. 对偶工整："静以修身"对"俭以养德"，结构相同，音韵和谐。<br/><br/>2. 言简意赅：用最简洁的语言概括了修身养德的核心方法。<br/><br/>3. 体现了儒家传统的修身观念，强调内在修养和品德培养的重要性。',
      showAnalysis: false
    },
    {
      id: 203,
      content: '<strong>【名句赏析】</strong><br/>"非淡泊无以明志，非宁静无以致远"<br/><br/><strong>【句意理解】</strong><br/>不恬淡寡欲就不能明确志向，不宁静就不能实现远大目标。',
      type: '名句赏析',
      year: '2026',
      answer: '这是全文最著名的句子，千百年来被广泛传诵。<br/><br/>"淡泊"指不追求名利，保持内心的平和；"明志"指明确自己的志向和目标。只有不被名利所困，才能看清自己真正想要的是什么。<br/><br/>"宁静"指心境平和，不浮躁；"致远"指实现远大的目标。只有心境宁静，才能沉下心来，一步一个脚印地走向目标。<br/><br/>这两句道出了立志与成才的关系，对今天的我们仍然具有重要的指导意义。',
      analysis: '1. 运用双重否定句式"非...无以..."，语气强烈，强调内心修养对实现人生目标的重要性。<br/><br/>2. 对偶工整，音韵和谐："非淡泊无以明志"对"非宁静无以致远"。<br/><br/>3. 逻辑严密：先要"明志"（明确目标），才能"致远"（实现目标）；先要"淡泊"（不慕名利），才能"宁静"（心境平和）。<br/><br/>4. 这句话成为千古名句，被后人铭记和践行。',
      showAnalysis: false
    },
    {
      id: 204,
      content: '<strong>【重点句段】</strong><br/>"夫学须静也，才须学也，非学无以广才，非志无以成学"<br/><br/><strong>【句意理解】</strong><br/>学习需要宁静，才干需要学习来增长，不学习就无法增长才干，没有志向就无法使学业有成。',
      type: '重点句段讲解',
      year: '2026',
      answer: '这几句话阐述了学习、才干、志向三者之间的关系。<br/><br/>首先强调"学须静"，学习必须在宁静的环境和心境中进行，这是前文"静以修身"的延续。<br/><br/>其次指出"才须学"，才能需要通过学习来培养和提高。<br/><br/>然后用双重否定强调："非学无以广才"—不学习就无法增长才干；"非志无以成学"—没有志向就无法使学业有成。<br/><br/>这四句环环相扣，构成了完整的治学之道。',
      analysis: '1. 逻辑链条：静→学→才→志，层层递进，构成完整的学习成才之路。<br/><br/>2. 强调了志向对学习的重要性，有了远大志向，才能持之以恒地学习。<br/><br/>3. 体现了诸葛亮对教育的深刻理解，学习不仅需要好的环境和方法，更需要坚定的志向。',
      showAnalysis: false
    },
    {
      id: 205,
      content: '<strong>【写作特色】</strong><br/>骈散结合，言简意赅',
      type: '写作特色分析',
      year: '2026',
      answer: '1. 骈散结合：全文既有对偶工整的骈句，如"静以修身，俭以养德"、"非淡泊无以明志，非宁静无以致远"，又有散句，如"夫学须静也，才须学也"，使文章既有节奏美，又不显呆板。<br/><br/>2. 言简意赅：全文仅86字（原文更长），却涵盖了修身、立志、治学等多个方面，可谓字字珠玑。<br/><br/>3. 层次分明：先谈修身（静、俭），再谈立志（淡泊、宁静），后谈治学（学、才、志），逻辑严密，层次清晰。',
      analysis: '1. 多用双重否定句式："非...无以..."，语气强烈，增强说服力。<br/><br/>2. 善用对偶：全文多处使用对偶，音韵和谐，易于记诵。<br/><br/>3. 论证严密：通过"静→俭→淡泊→宁静→学→才→志"的逻辑链条，构建了完整的人生修养体系。',
      showAnalysis: false
    },
    {
      id: 206,
      content: '<strong>【思想内涵】</strong><br/>儒家修身思想与道家清静无为的结合',
      type: '思想内涵探究',
      year: '2026',
      answer: '《诫子书》体现了儒家和道家思想的融合：<br/><br/>1. 儒家思想：强调修身、立志、治学，追求"修身齐家治国平天下"的人生理想。"静以修身，俭以养德"体现了儒家重视道德修养的传统。<br/><br/>2. 道家思想："淡泊"、"宁静"等概念体现了道家清静无为、不争名利的思想。强调内心的平和与超脱。<br/><br/>3. 两者结合：诸葛亮将儒家的积极进取与道家的超然物外相结合，既有远大志向，又能保持内心平和，体现了中国传统文化的智慧。',
      analysis: '1. 这种思想融合在诸葛亮的人生中得到充分体现：他既鞠躬尽瘁为国效力，又能在纷乱中保持内心的宁静。<br/><br/>2. 对今天的启示：在追求事业成功的同时，也要注重内心修养，保持平和的心态。<br/><br/>3. 体现了中国传统文化的包容性和综合性。',
      showAnalysis: false
    }
  ],
  
  // 《爱莲说》
  'ailiansuo': [
    {
      id: 301,
      content: '<strong>【原文】</strong><br/>水陆草木之花，可爱者甚蕃。晋陶渊明独爱菊。自李唐来，世人甚爱牡丹。予独爱莲之出淤泥而不染，濯清涟而不妖，中通外直，不蔓不枝，香远益清，亭亭净植，可远观而不可亵玩焉。<br/><br/><strong>【作者简介】</strong><br/>周敦颐（1017-1073），字茂叔，北宋理学家、哲学家。他是宋代理学的开山鼻祖，提出了"太极说"，对后世影响深远。<br/><br/><strong>【重点字词】</strong><br/>• 蕃（fán）：多<br/>• 淤（yū）泥：河沟或池塘里积存的污泥<br/>• 濯（zhuó）：洗涤<br/>• 清涟（lián）：水清而有微波的样子<br/>• 妖：妖艳<br/>• 中通外直：内部贯通，外形挺直<br/>• 亵（xiè）玩：玩弄',
      type: '课文精讲',
      year: '2026',
      answer: '作者通过描写莲花"出淤泥而不染"的高洁品质，托物言志，表达了自己不慕名利、洁身自好的生活态度，以及在污浊环境中保持高洁品格的人生追求。<br/><br/>文章首先列举了陶渊明爱菊、世人爱牡丹的例子，然后引出自己独爱莲花。莲花生长在污泥之中却不沾染污秽，经过清水洗涤却不显得妖艳，象征君子身处浊世而能保持清白的品格。',
      analysis: '1. 托物言志：借莲花的自然特征来表达作者的人生理想和道德追求，"莲"象征高洁品格，"淤泥"象征污浊的社会环境。<br/><br/>2. 对比衬托：用陶渊明爱菊象征隐逸，世人爱牡丹象征富贵，衬托出作者爱莲的独特之处，突出莲的高洁品质。<br/><br/>3. 正面描写：从形态、香气、姿态等多角度描写莲花，形象生动。',
      showAnalysis: false
    },
    {
      id: 302,
      content: '<strong>【名句赏析】</strong><br/>"出淤泥而不染，濯清涟而不妖"<br/><br/><strong>【句意理解】</strong><br/>从淤泥中长出来却不沾染污秽，经过清水洗涤却不显得妖艳。',
      type: '名句赏析',
      year: '2026',
      answer: '这是全文最著名的句子，成为描写高洁品格的千古名句。<br/><br/>"出淤泥而不染"：莲花生长在污泥之中，却不被污泥所玷污，象征君子身处污浊环境却能保持高洁的品格。<br/><br/>"濯清涟而不妖"：经过清水洗涤，却不显得妖艳，说明莲花的美是自然朴素的美，不是刻意装扮的美。<br/><br/>两句从不同角度赞美莲花的品质：一是不受环境影响，二是不追求外表华丽。这正是君子应有的品格。',
      analysis: '1. 对偶工整："出淤泥而不染"对"濯清涟而不妖"，结构相同，音韵和谐。<br/><br/>2. 用字精准："染"字写出了环境的污浊，"妖"字点出了世俗的华丽，两字对比鲜明。<br/><br/>3. 象征深刻："淤泥"象征污浊的社会环境，"清涟"象征世俗的诱惑，"不染"、"不妖"展现了君子的品格。<br/><br/>4. 这两句成为后世形容高洁品格的经典名句。',
      showAnalysis: false
    },
    {
      id: 303,
      content: '<strong>【名句赏析】</strong><br/>"中通外直，不蔓不枝"<br/><br/><strong>【句意理解】</strong><br/>（茎）内部贯通，外形挺直，不生蔓藤，不长旁枝。',
      type: '名句赏析',
      year: '2026',
      answer: '这两句从莲花的形态特征进一步刻画其品格。<br/><br/>"中通外直"：内部贯通象征内心通达，外形挺直象征品行正直。内外一致，表里如一，这是君子的重要品质。<br/><br/>"不蔓不枝"：不生蔓藤，不长旁枝，说明莲花生长专一，不旁逸斜出。象征君子做人专注，不攀附权贵，不趋炎附势。<br/><br/>这两句赞美莲花品格的纯正和专一。',
      analysis: '1. 由外到内，层层深入：先写外形（直），再写内部（通），最后写生长特点（不蔓不枝）。<br/><br/>2. 托物言志：通过莲花的形态特征，暗喻君子应当内心通达、品行正直、为人专一的品格。<br/><br/>3. 语言简洁：用短短六个字，刻画出莲花完整的形态特征和精神品质。',
      showAnalysis: false
    },
    {
      id: 304,
      content: '<strong>【写作手法】</strong><br/>对比衬托',
      type: '写作手法分析',
      year: '2026',
      answer: '文章通过三种花的对比，层层衬托出莲花的高洁品格：<br/><br/>1. 菊花——隐逸之士：陶渊明独爱菊，菊花象征隐居避世、不与世俗同流合污的隐逸之士。但隐逸是消极的，逃避现实的。<br/><br/>2. 牡丹——富贵之人：世人甚爱牡丹，牡丹象征富贵荣华，追求物质享受的人。但这是庸俗的，缺乏精神追求的。<br/><br/>3. 莲花——君子之风：作者独爱莲，莲花象征既不逃避现实（生于淤泥），又能保持高洁品格（不染）的君子。这是积极的，既入世又超脱的。<br/><br/>通过对比，突出了莲花（君子）的可贵之处。',
      analysis: '1. 三种花代表三种人生态度：菊花代表消极避世，牡丹代表追求富贵，莲花代表洁身自好。<br/><br/>2. 层层推进：先写众人之爱（菊、牡丹），再写"予"之爱（莲），突出作者的独特选择。<br/><br/>3. 以物喻人：通过对花的喜爱，表达对不同人生态度的评价和自己的人生追求。',
      showAnalysis: false
    },
    {
      id: 305,
      content: '<strong>【托物言志手法】</strong><br/>以莲喻君子，寄托理想',
      type: '托物言志详解',
      year: '2026',
      answer: '托物言志是《爱莲说》最主要的写作手法，作者通过对莲花的描写和赞美，寄托了自己的人生理想和道德追求。<br/><br/>1. 物的选择：作者选择莲花，是因为莲花生长在淤泥之中却能保持洁净，这与作者所处的社会环境和他的人生追求相契合。<br/><br/>2. 物的特征：作者重点描写了莲花的几个特征——出淤泥而不染、濯清涟而不妖、中通外直、不蔓不枝，这些都是君子应有的品格。<br/><br/>3. 志的表达：通过对莲花的赞美，表达了作者不慕名利、洁身自好、品行正直的人生追求。',
      analysis: '1. 自然与人格的契合：莲花的自然特征与君子的道德品质完美契合，使得托物言志水到渠成。<br/><br/>2. 含蓄蕴藉：不直接说教，而是通过对莲花的描写，让读者自然领悟其中的道理。<br/><br/>3. 情景交融：作者的情感与莲花的形象融为一体，既是写花，也是写人，更是写理想。',
      showAnalysis: false
    },
    {
      id: 306,
      content: '<strong>【语言特色】</strong><br/>骈散结合，音韵和谐',
      type: '语言特色分析',
      year: '2026',
      answer: '《爱莲说》的语言具有鲜明的特色：<br/><br/>1. 骈散结合：全文以散句为主，但关键处使用骈句，如"出淤泥而不染，濯清涟而不妖"、"中通外直，不蔓不枝"，使文章既有节奏美，又不失自然流畅。<br/><br/>2. 对偶工整：多处使用对偶句，如"予独爱莲之出淤泥而不染，濯清涟而不妖"，音韵和谐，朗朗上口。<br/><br/>3. 用词精练：如"染"、"妖"、"植"等字，一字传神，准确生动。<br/><br/>4. 句式多变：长短句交错使用，使文章富有节奏感和韵律美。',
      analysis: '1. 全文仅119字（原文），却涵盖了对莲花的全面描写和深刻寓意，堪称言简意赅的典范。<br/><br/>2. 音韵和谐：多用"之"、"而"等虚词，增强了文章的音韵美。<br/><br/>3. 形象生动：用"出"、"濯"、"通"、"直"等动词，使静态的莲花具有了动态美。<br/><br/>4. 这种语言风格既符合古文的典雅，又具有散文的自然流畅，成为后世散文的典范。',
      showAnalysis: false
    }
  ],
  'unit-overview': {
    id: 4,
    content: '<strong>【课文导读】</strong><br/>《论语》是儒家经典著作之一，记录了孔子及其弟子的言行。本单元选取的十二章，涉及学习方法、学习态度、修身做人等多个方面，对今天的我们仍有重要的启示意义。<br/><br/><strong>【学习方法篇】</strong><br/>• "学而时习之"——强调及时复习的重要性<br/>• "温故而知新"——从已学知识中获得新的理解<br/>• "学而不思则罔，思而不学则殆"——学习与思考相结合<br/><br/><strong>【学习态度篇】</strong><br/>• "三人行，必有我师焉"——虚心向他人学习<br/>• "知之为知之，不知为不知"——实事求是的态度<br/>• "敏而好学，不耻下问"——勤奋好学，谦虚请教',
    type: '单元知识梳理',
    year: '2026',
    answer: '《论语》十二章从多个角度阐述了学习和修身的道理，主要包括三个方面：<br/><br/>1. 学习方法：强调温故知新、学思结合，既要勤于复习，又要善于思考，将学习和思考有机结合起来。<br/><br/>2. 学习态度：提倡虚心求教、实事求是，要善于向他人学习，对于知识要诚实，知道就是知道，不知道就是不知道。<br/><br/>3. 修身做人：要求宽容待人、见贤思齐，遵循"己所不欲，勿施于人"的原则，向优秀的人学习，不断提升自己的品格修养。',
    analysis: '1. 这些语句言简意赅，却蕴含着深刻的教育哲理，两千多年来一直被奉为经典，影响着一代又一代人。<br/><br/>2. 学习建议：熟读成诵，在反复诵读中理解文意；联系实际，将所学道理与自己的学习生活相结合；活学活用，在日常学习和生活中践行这些道理；积累背诵，重点句子要能够准确默写，内化为自己的语言财富。<br/><br/>3. 现实意义：这些语句不仅适用于古代，对今天的我们同样具有重要的指导意义，帮助我们树立正确的学习观和人生观。',
    showAnalysis: false
  }
}

// 当前显示的内容列表
const questionList = ref([])

// 大屏展示相关
const screenDialogVisible = ref(false)
const currentScreenQuestion = ref(null)
const currentScreenIndex = ref(0)

// 根据contentId加载内容（单个）
const loadContentById = (contentId) => {
  const contents = contentLibrary[contentId]
  if (contents) {
    // 如果是数组，直接使用；如果是单个对象，转为数组
    questionList.value = Array.isArray(contents) ? contents : [contents]
  } else {
    questionList.value = []
    ElMessage.info('该章节内容正在编写中...')
  }
}

// 根据多个contentId加载内容（聚合）
const loadContentByIds = (contentIds) => {
  const allContents = []
  
  contentIds.forEach(contentId => {
    const contents = contentLibrary[contentId]
    if (contents) {
      // 如果是数组，展开所有内容；如果是单个对象，作为一项添加
      if (Array.isArray(contents)) {
        allContents.push(...contents)
      } else {
        allContents.push(contents)
      }
    }
  })
  
  questionList.value = allContents
}

// 点击图书卡片
const handleBookClick = (book) => {
  currentBook.value = book
  showQuestionList.value = true
  // 默认展开第一个一级目录并加载其所有内容
  if (catalogTree.value.length > 0) {
    const firstNode = catalogTree.value[0]
    firstNode.expanded = true
    selectCatalog(firstNode)
  }
}

// 切换答案解析显示状态
const toggleAnalysis = (question) => {
  question.showAnalysis = !question.showAnalysis
}

// 添加题目到备考篮
const addQuestionToBasket = (question) => {
  addToBasket(question)
  ElMessage.success(`已将"${question.type}"加入备考篮`)
}

// 大屏展示
const handleScreenShow = (question) => {
  // 找到当前题目在列表中的索引
  currentScreenIndex.value = questionList.value.findIndex(q => q.id === question.id)
  currentScreenQuestion.value = question
  screenDialogVisible.value = true
}

// 关闭大屏展示
const closeScreenPresentation = () => {
  screenDialogVisible.value = false
}

// 切换大屏展示的题目
const changeScreenQuestion = (index) => {
  if (index >= 0 && index < questionList.value.length) {
    currentScreenIndex.value = index
    currentScreenQuestion.value = questionList.value[index]
  }
}
</script>

<style scoped>
.platform-sharing {
  padding: 20px 24px;
  min-height: 100%;
  background-color: #ffffff;
  border-radius: 5px 0 0 0;
}

/* 试题模式下使用透明背景 */
.platform-sharing.question-mode {
  background-color: transparent;
  border-radius: 0;
}

.selection-top {
  display: flex;
  gap: 12px;
  margin-bottom: 16px;
  flex-wrap: wrap;
  align-items: center;
}

.selection-nav {
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  margin-bottom: 20px;
  padding: 0 20px;
  background: #fff;
  height: 52px;
  border-bottom: 2px solid #e4e7ed;
  position: relative;
}

.nav-list {
  display: flex;
  gap: 36px;
  list-style: none;
  margin: 0;
  padding: 0;
}

.nav-list li {
  font-size: 16px;
  color: #606266;
  cursor: pointer;
  padding: 10px 0;
  margin-bottom: -2px;
  border-bottom: 2px solid transparent;
  transition: all 0.3s;
  font-weight: 400;
  position: relative;
  z-index: 1;
}

.nav-list li:hover {
  color: #2262FB;
}

.nav-list li.active {
  color: #2262FB;
  font-weight: 500;
  border-bottom-color: #2262FB;
}

.view-toggle {
  display: flex;
  gap: 8px;
  margin-bottom: -2px;
  padding-bottom: 10px;
}

.view-icon {
  font-size: 22px;
  color: #909399;
  cursor: pointer;
  padding: 4px;
  border-radius: 3px;
  transition: all 0.3s;
}

.view-icon:hover {
  color: #409eff;
  background: rgba(64, 158, 255, 0.1);
}

.view-icon.active {
  color: #409eff;
  background: rgba(64, 158, 255, 0.12);
}

.list-view {
  background: #fff;
  border-radius: 4px;
  padding: 16px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
}

.grid-view {
  background: transparent;
  border-radius: 0;
  padding: 0;
  box-shadow: none;
}

.resource-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px 16px;
  margin-bottom: 24px;
}

.card-wrapper {
  cursor: pointer;
}

.resource-card {
  background: transparent;
  border: none;
  overflow: visible;
  transition: all 0.3s;
  margin-bottom: 12px;
}

.card-wrapper:hover .card-cover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  transform: translateY(-2px);
}

.card-cover {
  width: 100%;
  height: 188px;
  background: #fff;
  position: relative;
  overflow: hidden;
  transition: all 0.3s;
}

.card-cover :deep(.el-image) {
  width: 100%;
  height: 100%;
}

.card-cover :deep(.el-image img) {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.image-slot {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  background: #f5f7fa;
  color: #ccc;
  font-size: 48px;
}

.card-title {
  padding: 0;
  font-size: 14px;
  color: #303133;
  font-weight: 400;
  min-height: 44px;
  line-height: 1.5;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
  overflow: hidden;
  text-overflow: ellipsis;
  text-align: center;
}

.pagination {
  display: flex;
  justify-content: center;
  margin-top: 24px;
  padding: 16px 0;
}

@media (max-width: 768px) {
  .platform-sharing {
    padding: 16px;
  }
  
  .selection-top {
    flex-direction: column;
  }
  
  .selection-top > * {
    width: 100% !important;
  }
  
  .resource-grid {
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 16px;
  }
}

/* 题目列表样式 */
.question-view {
  animation: fadeIn 0.3s;
}

/* 题目内容区域布局 */
.question-content-wrapper {
  display: flex;
  gap: 20px;
  background-color: transparent;
  align-items: flex-start;
}

/* 左侧边栏样式 */
.left-sidebar {
  width: 320px;
  background: #ffffff;
  border-radius: 4px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  padding: 16px;
  position: sticky;
  top: 0;
  align-self: flex-start;
  max-height: calc(100vh - 140px);
  overflow-y: auto;
}

.sidebar-header {
  text-align: center;
  padding-bottom: 16px;
}

.catalog-title {
  font-size: 16px;
  font-weight: 600;
  color: #303133;
}

.sidebar-content {
  margin-top: 8px;
}

.catalog-tree {
  display: flex;
  flex-direction: column;
}

.catalog-item {
  margin-bottom: 0;
}

.catalog-node {
  display: flex;
  align-items: center;
  padding: 10px 12px;
  cursor: pointer;
  transition: all 0.2s;
  border-radius: 4px;
  user-select: none;
}

.catalog-node:hover {
  background: #f5f7fa;
}

.catalog-node.active {
  background: #ecf5ff;
  color: #2262FB;
}

.catalog-node .expand-icon-wrapper {
  width: 18px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: flex-start;
}

.expand-icon {
  font-size: 14px;
  color: #909399;
  transition: transform 0.3s;
}

.expand-icon.expanded {
  transform: rotate(90deg);
}

.node-label {
  flex: 1;
  font-size: 14px;
  color: #606266;
}

.catalog-node.active .node-label {
  color: #2262FB;
  font-weight: 500;
}

.level-1 {
  font-size: 14px;
  font-weight: 500;
}

.level-2 {
  padding-left: 24px;
  font-size: 13px;
}

.level-3 {
  padding-left: 36px;
  font-size: 13px;
  color: #606266;
}

/* 子节点容器 */
.catalog-children {
  margin: 0;
}

/* 右侧内容区样式 */
.right-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  background: #ffffff;
  border-radius: 4px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  padding: 20px;
  min-width: 0;
}

/* 内容统计头部 */
.content-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px;
  margin: -20px -20px 16px -20px;
  border-bottom: 1px solid #e4e7ed;
  position: sticky;
  top: 0;
  background: #ffffff;
  z-index: 10;
  backdrop-filter: blur(10px);
}

/* 内容信息区（标题+数量统计） */
.content-info {
  display: flex;
  align-items: baseline;
  gap: 12px;
  flex: 1;
}

.content-title {
  display: flex;
  align-items: center;
}

.title-text {
  font-size: 16px;
  font-weight: 600;
  color: #303133;
}

.content-count {
  display: flex;
  align-items: baseline;
  gap: 4px;
}

.count-label {
  font-size: 14px;
  color: #909399;
}

.count-number {
  font-size: 16px;
  font-weight: 600;
  color: #2262FB;
  margin: 0 2px;
}

/* 操作按钮区 */
.action-buttons {
  display: flex;
  gap: 0px;
}

.action-buttons .el-button {
  padding: 6px 4px;
  font-size: 14px;
  border: none;
  background-color: transparent;
  color: #606266;
  transition: all 0.3s ease;
  border-radius: 6px;
}

.action-buttons .el-button:hover {
  transform: translateY(-2px);
}

.action-buttons .el-button .el-icon {
  margin-right: 4px;
  font-size: 16px;
  transition: transform 0.3s ease;
}

/* 收藏按钮 */
.action-buttons .el-button:nth-child(1) {
  color: #F59E0B;
}

.action-buttons .el-button:nth-child(1):hover {
  background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
  color: #D97706;
  box-shadow: 0 4px 12px rgba(245, 158, 11, 0.2);
}

.action-buttons .el-button:nth-child(1):hover .el-icon {
  transform: scale(1.2) rotate(18deg);
}

/* 编辑按钮 */
.action-buttons .el-button:nth-child(2) {
  color: #2262FB;
}

.action-buttons .el-button:nth-child(2):hover {
  background: linear-gradient(135deg, #EFF6FF 0%, #DBEAFE 100%);
  color: #1e54e0;
  box-shadow: 0 4px 12px rgba(34, 98, 251, 0.2);
}

.action-buttons .el-button:nth-child(2):hover .el-icon {
  transform: scale(1.2);
}

/* 下载按钮 */
.action-buttons .el-button:nth-child(3) {
  color: #10B981;
}

.action-buttons .el-button:nth-child(3):hover {
  background: linear-gradient(135deg, #D1FAE5 0%, #A7F3D0 100%);
  color: #059669;
  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
}

.action-buttons .el-button:nth-child(3):hover .el-icon {
  transform: scale(1.2) translateY(2px);
}

.action-buttons .el-button:active {
  transform: translateY(0);
}

/* 筛选区域样式 */
.filter-section {
  background: #ffffff;
  padding: 20px;
  margin-bottom: 20px;
  border: 1px solid #e4e7ed;
  border-radius: 4px;
}

.filter-row {
  display: flex;
  margin-bottom: 16px;
  align-items: flex-start;
}

.filter-row:last-child {
  margin-bottom: 0;
}

.filter-label {
  flex-shrink: 0;
  width: 100px;
  font-size: 14px;
  color: #303133;
  line-height: 32px;
  text-align: right;
  padding-right: 12px;
}

.filter-options {
  flex: 1;
  display: flex;
  flex-wrap: wrap;
  gap: 12px 24px;
}

/* Element Plus Radio 自定义样式 */
.custom-radio {
  margin-right: 0;
  height: 32px;
}

.custom-radio :deep(.el-radio__label) {
  font-size: 14px;
  color: #606266;
  padding-left: 8px;
}

.custom-radio :deep(.el-radio__inner) {
  width: 16px;
  height: 16px;
  border-color: #dcdfe6;
  background-color: #ffffff;
}

.custom-radio :deep(.el-radio__inner::after) {
  width: 6px;
  height: 6px;
  background-color: #ffffff;
}

.custom-radio:hover :deep(.el-radio__inner) {
  border-color: #2262FB;
}

.custom-radio:hover :deep(.el-radio__label) {
  color: #2262FB;
}

.custom-radio.is-checked :deep(.el-radio__inner) {
  border-color: #2262FB;
  background-color: #2262FB;
}

.custom-radio.is-checked :deep(.el-radio__inner::after) {
  background-color: #ffffff;
}

.custom-radio.is-checked :deep(.el-radio__label) {
  color: #2262FB;
  font-weight: 500;
}

/* 题目列表 */
.question-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.question-item {
  background: #ffffff;
  border: 1px solid #e4e7ed;
  border-radius: 4px;
  padding: 20px;
  transition: all 0.3s;
}

.question-item:hover {
  border-color: #2262FB;
  box-shadow: 0 2px 8px rgba(34, 98, 251, 0.15);
}

.question-header {
  position: relative;
  margin-bottom: 16px;
  display: flex;
  gap: 12px;
  align-items: flex-start;
}

.question-number {
  flex-shrink: 0;
  font-size: 14px;
  font-weight: 500;
  color: #2262FB;
  line-height: 1.8;
}

.question-text {
  flex: 1;
  font-size: 14px;
  line-height: 1.8;
  color: #303133;
  padding-right: 120px;
}

.question-text :deep(br) {
  display: block;
  margin: 8px 0;
  content: "";
}

.btn-screen {
  position: absolute;
  top: 0;
  right: 0;
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 20px;
  background-color: #2262FB;
  color: #ffffff;
  border: none;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s;
  outline: none;
}

.btn-screen:hover {
  background-color: #4a7dfc;
}

.btn-screen .el-icon {
  font-size: 16px;
}

.analysis-section {
  background-color: #f5f7fa;
  padding: 16px 20px;
  margin-bottom: 16px;
  border-radius: 4px;
  line-height: 1.8;
  animation: slideDown 0.3s ease-out;
}

.analysis-block {
  margin-bottom: 16px;
}

.analysis-block:last-child {
  margin-bottom: 0;
}

.analysis-title {
  font-size: 15px;
  font-weight: 600;
  color: #303133;
  margin-bottom: 8px;
}

.analysis-content {
  font-size: 14px;
  color: #303133;
  line-height: 1.8;
}

/* 详解内容HTML样式 */
.analysis-content :deep(strong) {
  font-weight: 600;
  color: #2262FB;
  margin-bottom: 6px;
}

.analysis-content :deep(br) {
  display: block;
  margin: 4px 0;
  content: "";
}

.analysis-content :deep(ul),
.analysis-content :deep(ol) {
  margin: 8px 0;
  padding-left: 20px;
}

.question-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 12px;
  border-top: 1px solid #f0f0f0;
  gap: 20px;
}

.question-meta {
  display: flex;
  flex-wrap: wrap;
  gap: 24px;
  flex: 1;
}

.meta-item {
  font-size: 14px;
  color: #909399;
}

.question-actions {
  display: flex;
  gap: 4px;
  flex-shrink: 0;
}

.btn-analysis,
.btn-add {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s;
  outline: none;
  background-color: transparent;
  color: #2262FB;
  border: none;
}

.btn-analysis:hover,
.btn-add:hover {
  background-color: #f0f5ff;
}

.btn-add:active {
  background-color: #e0edff;
  transform: scale(0.98);
}

.btn-analysis .el-icon,
.btn-add .el-icon {
  font-size: 16px;
}

@keyframes slideDown {
  from {
    opacity: 0;
    max-height: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    max-height: 500px;
    transform: translateY(0);
  }
}

/* 编辑模式样式 */
.edit-mode-wrapper {
  width: 100%;
  height: calc(100vh - 150px);
  background-color: transparent;
  display: flex;
  justify-content: center;
}

.right-edit-content {
  width: 800px;
  height: 100%;
  display: flex;
  flex-direction: column;
  background: #ffffff;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  overflow: hidden;
}

.edit-content {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
  background: #ffffff;
  width: 100%;
}

.edit-content::-webkit-scrollbar {
  width: 8px;
}

.edit-content::-webkit-scrollbar-thumb {
  background: #c0c4cc;
  border-radius: 4px;
}

.edit-content::-webkit-scrollbar-thumb:hover {
  background: #909399;
}

.edit-content::-webkit-scrollbar-track {
  background: #f5f7fa;
  border-radius: 4px;
}

.edit-question-item {
  background: #ffffff;
  border: 1px solid #e4e7ed;
  border-radius: 4px;
  padding: 20px;
  margin-bottom: 16px;
  transition: all 0.3s;
}

.edit-question-item:hover {
  border-color: #c0c4cc;
}

.question-header-edit {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
  padding-bottom: 16px;
  border-bottom: 1px solid #e4e7ed;
}

.question-number-edit {
  font-size: 16px;
  font-weight: 600;
  color: #2262FB;
  min-width: 40px;
}

.question-title-edit {
  font-size: 14px;
  font-weight: 500;
  color: #606266;
  padding: 4px 12px;
  background: #f0f4ff;
  border-radius: 4px;
}

.question-meta-edit {
  flex: 1;
  display: flex;
  gap: 16px;
  color: #909399;
  font-size: 14px;
}

.question-actions-edit {
  display: flex;
  gap: 8px;
}

.question-body-edit {
  line-height: 1.8;
  color: #303133;
}

.question-body-edit .question-content {
  font-size: 15px;
}
</style>

